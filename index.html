<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>净土</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="满纸荒唐言，一腔牢骚话">
<meta property="og:type" content="website">
<meta property="og:title" content="净土">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="净土">
<meta property="og:description" content="满纸荒唐言，一腔牢骚话">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="svensma">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/myblogs.github.io/atom.xml" title="净土" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/myblogs.github.io/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/myblogs.github.io/" id="logo">净土</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/myblogs.github.io/">Home</a>
        
          <a class="main-nav-link" href="/myblogs.github.io/archives">Archives</a>
        
          <a class="main-nav-link" href="/myblogs.github.io/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/myblogs.github.io/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Auto render and output in Blender with Python" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2021/05/11/Auto%20render%20and%20output%20in%20Blender%20with%20Python/" class="article-date">
  <time datetime="2021-05-11T03:06:46.000Z" itemprop="datePublished">2021-05-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Game-Dev/">Game Dev</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2021/05/11/Auto%20render%20and%20output%20in%20Blender%20with%20Python/">Blender Python API Render And Output</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>利用Python实现在Blender中自动导出所有相机角度下的Action。</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bpy</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> join</span><br><span class="line"></span><br><span class="line">CAMERA_FRONT = <span class="string">&quot;Front&quot;</span></span><br><span class="line">CAMERA_BACK = <span class="string">&quot;Back&quot;</span></span><br><span class="line">CAMERA_LEFT = <span class="string">&quot;Slide.L&quot;</span></span><br><span class="line">CAMERA_RIGHT = <span class="string">&quot;Slide.R&quot;</span></span><br><span class="line"></span><br><span class="line">CHARACTER_NAME = <span class="string">&quot;character_test&quot;</span></span><br><span class="line"></span><br><span class="line">ROOT_OUTPUT_FOLDER = <span class="string">&quot;C:/tmp/&quot;</span></span><br><span class="line"></span><br><span class="line">TOTAL_FRAMES = <span class="number">11</span> <span class="comment">#(0~10)</span></span><br><span class="line"></span><br><span class="line">BATTLE_ANIMATION_ACTIONS = [<span class="string">&quot;atk&quot;</span>, <span class="string">&quot;be_hit&quot;</span>, <span class="string">&quot;die&quot;</span>, <span class="string">&quot;idle&quot;</span>, <span class="string">&quot;skill&quot;</span>]</span><br><span class="line">MOVE_ANIMATION_ACTION = <span class="string">&quot;run&quot;</span></span><br><span class="line"></span><br><span class="line">CURRENT_SCENE = bpy.context.scene</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">render_animate</span>(<span class="params">middle_path</span>):</span></span><br><span class="line">    current_folder = ROOT_OUTPUT_FOLDER + middle_path</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> range(TOTAL_FRAMES):</span><br><span class="line">        CURRENT_SCENE.frame_set(f)</span><br><span class="line">        <span class="keyword">if</span> f &lt; <span class="number">10</span>:</span><br><span class="line">            file_name = <span class="string">&quot;000&#123;&#125;&quot;</span>.format(f)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            file_name = <span class="string">&quot;00&#123;&#125;&#123;&#125;&quot;</span>.format(<span class="number">1</span>, f%<span class="number">10</span>)</span><br><span class="line">        <span class="comment"># file_name += scene.render.file_extension</span></span><br><span class="line">        file_name += <span class="string">&quot;.png&quot;</span></span><br><span class="line">        bpy.context.scene.render.filepath = join(current_folder, file_name)</span><br><span class="line">        bpy.ops.render.render(write_still = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_battle</span>():</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; left &#x27;&#x27;&#x27;</span></span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_RIGHT]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    <span class="keyword">for</span> action <span class="keyword">in</span> BATTLE_ANIMATION_ACTIONS:</span><br><span class="line">        temp_battle = CHARACTER_NAME + <span class="string">&quot;/battle/left/l_&quot;</span> + action + <span class="string">&quot;/&quot;</span></span><br><span class="line">        bpy.context.object.animation_data.action = bpy.data.actions.get(action)</span><br><span class="line">        render_animate(temp_battle)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; right &#x27;&#x27;&#x27;</span></span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_LEFT]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    <span class="keyword">for</span> action <span class="keyword">in</span> BATTLE_ANIMATION_ACTIONS:</span><br><span class="line">        temp_battle = CHARACTER_NAME + <span class="string">&quot;/battle/right/&quot;</span> + action + <span class="string">&quot;/&quot;</span></span><br><span class="line">        bpy.context.object.animation_data.action = bpy.data.actions.get(action)</span><br><span class="line">        render_animate(temp_battle)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_move</span>():</span></span><br><span class="line">    bpy.context.object.animation_data.action = bpy.data.actions.get(MOVE_ANIMATION_ACTION)</span><br><span class="line">    </span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_FRONT]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    temp_battle = CHARACTER_NAME + <span class="string">&quot;/move/down/&quot;</span></span><br><span class="line">    render_animate(temp_battle)</span><br><span class="line"></span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_BACK]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    temp_battle = CHARACTER_NAME + <span class="string">&quot;/move/up/&quot;</span></span><br><span class="line">    render_animate(temp_battle)</span><br><span class="line"></span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_RIGHT]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    temp_battle = CHARACTER_NAME + <span class="string">&quot;/move/left/&quot;</span></span><br><span class="line">    render_animate(temp_battle)</span><br><span class="line"></span><br><span class="line">    target_camera = bpy.data.objects[CAMERA_LEFT]</span><br><span class="line">    bpy.context.scene.camera = target_camera</span><br><span class="line">    temp_battle = CHARACTER_NAME + <span class="string">&quot;/move/right/&quot;</span></span><br><span class="line">    render_animate(temp_battle)</span><br><span class="line"></span><br><span class="line">generate_battle()</span><br><span class="line">generate_move()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/05/11/Auto%20render%20and%20output%20in%20Blender%20with%20Python/" data-id="ckokz510s0000wsqra5o2hg95" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-cowboy-websocket" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/11/09/cowboy-websocket/" class="article-date">
  <time datetime="2020-11-09T08:25:23.000Z" itemprop="datePublished">2020-11-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Erlang/">Erlang</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/11/09/cowboy-websocket/">cowboy websocket (boardcast)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="websocket连接管理-这里存储在ets里面"><a href="#websocket连接管理-这里存储在ets里面" class="headerlink" title="websocket连接管理,这里存储在ets里面:"></a>websocket连接管理,这里存储在ets里面:</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">-module</span> <span class="params">(conn_ets)</span>.</span><br><span class="line"><span class="keyword">-export</span> <span class="params">([init/<span class="number">0</span>, insert/<span class="number">2</span>, lookup/<span class="number">1</span>, remove_by_id/<span class="number">1</span>, remove_by_pid/<span class="number">1</span>, get_online_num/<span class="number">0</span>])</span>.</span><br><span class="line"></span><br><span class="line"><span class="keyword">-define</span><span class="params">(TABLE_ID, ?MODULE)</span>.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">init</span><span class="params">()</span> -&gt;</span></span><br><span class="line">    ets:new(?TABLE_ID, [bag, public, named_table]),</span><br><span class="line">    ok.</span><br><span class="line"></span><br><span class="line"><span class="comment">%% login success insert id and pid.</span></span><br><span class="line"><span class="function"><span class="title">insert</span><span class="params">( GId, Pid )</span> <span class="title">when</span> <span class="title">is_pid</span><span class="params">(Pid)</span> -&gt;</span></span><br><span class="line">    ets:insert(?TABLE_ID, &#123; GId, Pid &#125;).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">lookup</span><span class="params">(GId)</span> -&gt;</span></span><br><span class="line">    ets:lookup(?TABLE_ID, GId).</span><br><span class="line"></span><br><span class="line"><span class="comment">%% get pid by id</span></span><br><span class="line"><span class="comment">% lookup(GId) -&gt;</span></span><br><span class="line"><span class="comment">%     case ets:lookup(?TABLE_ID, GId) of</span></span><br><span class="line"><span class="comment">%         [&#123;GId, Pid&#125;] -&gt; &#123;ok, &#123;GId, Pid&#125;&#125;;</span></span><br><span class="line"><span class="comment">%         []            -&gt; &#123;error, not_found&#125;</span></span><br><span class="line"><span class="comment">%     end.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%% logout remove online user</span></span><br><span class="line"><span class="function"><span class="title">remove_by_id</span><span class="params">(GId)</span> -&gt;</span></span><br><span class="line">    ets:match_delete(?TABLE_ID, &#123;GId, &#x27;_&#x27;&#125;).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">remove_by_pid</span><span class="params">(Pid)</span> -&gt;</span></span><br><span class="line">    ets:match_delete(?TABLE_ID, &#123;&#x27;_&#x27;, Pid&#125;).</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">get_online_num</span><span class="params">()</span> -&gt;</span></span><br><span class="line">    length(ets:tab2list(?TABLE_ID)).</span><br></pre></td></tr></table></figure>

<h3 id="websocket-回调模块"><a href="#websocket-回调模块" class="headerlink" title="websocket 回调模块:"></a>websocket 回调模块:</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">-module</span><span class="params">(ws_h)</span>.</span><br><span class="line"></span><br><span class="line"><span class="keyword">-export</span><span class="params">([init/<span class="number">2</span>])</span>.</span><br><span class="line"><span class="keyword">-export</span><span class="params">([websocket_init/<span class="number">1</span>])</span>.</span><br><span class="line"><span class="keyword">-export</span><span class="params">([websocket_handle/<span class="number">2</span>])</span>.</span><br><span class="line"><span class="keyword">-export</span><span class="params">([websocket_info/<span class="number">2</span>])</span>.</span><br><span class="line"><span class="keyword">-export</span><span class="params">([terminate/<span class="number">3</span>])</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">% -record(state, &#123;pid, id&#125;).</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">init</span><span class="params">(Req, Opts)</span> -&gt;</span></span><br><span class="line">    #&#123;pid := Pid&#125; = Req,</span><br><span class="line">    conn_ets:insert(<span class="string">&quot;chat_room&quot;</span>, Pid),</span><br><span class="line">    &#123;cowboy_websocket, Req, Opts&#125;.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_init</span><span class="params">(State)</span> -&gt;</span></span><br><span class="line">    <span class="comment">% erlang:start_timer(1000, self(), &lt;&lt;&quot;Hello!&quot;&gt;&gt;),</span></span><br><span class="line">    &#123;[&#123;text, &lt;&lt;<span class="string">&quot;Immediately Hello!&quot;</span>&gt;&gt;&#125;], State&#125;.</span><br><span class="line">    <span class="comment">% self()! &#123;[&#123;text, &lt;&lt;&quot;Hello Response&quot;&gt;&gt;&#125;], State&#125;,</span></span><br><span class="line">    <span class="comment">% &#123;[], State&#125;.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_handle</span><span class="params">(&#123;text, Msg&#125;, State)</span> -&gt;</span></span><br><span class="line">    lists:foreach(</span><br><span class="line">        <span class="keyword">fun</span>(&#123;_, CurrPid&#125;) -&gt; </span><br><span class="line">            <span class="comment">% io:format(&quot;Boardcast: ~w ~n&quot;, [CurrPid])</span></span><br><span class="line">            CurrPid ! &#123; chat, &lt;&lt;<span class="string">&quot;Boardcast message: &quot;</span>, Msg/binary&gt;&gt; &#125;</span><br><span class="line">        <span class="keyword">end</span>,</span><br><span class="line">        conn_ets:lookup(<span class="string">&quot;chat_room&quot;</span>)</span><br><span class="line">        ),</span><br><span class="line">    <span class="comment">% io:format(&quot;Terminate reason: ~w ~n&quot;, [conn_ets:lookup(&quot;chat_room&quot;)]),</span></span><br><span class="line">    <span class="comment">% self() ! &#123; chat, &lt;&lt;&quot;Boardcast message: &quot;, Msg/binary&gt;&gt; &#125;,</span></span><br><span class="line">    &#123;[], State&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_handle</span><span class="params">(_Data, State)</span> -&gt;</span></span><br><span class="line">    &#123;[], State&#125;.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_info</span><span class="params">(&#123;chat, Msg&#125;, State)</span>-&gt;</span></span><br><span class="line">    io:format(<span class="string">&quot;chat ~w~n&quot;</span>, [Msg]),</span><br><span class="line">    &#123;[&#123;text,Msg&#125;], State&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_info</span><span class="params">(&#123;timeout, _Ref, Msg&#125;, State)</span> -&gt;</span></span><br><span class="line">    erlang:start_timer(<span class="number">1000</span>, self(), &lt;&lt;<span class="string">&quot;How&#x27; you doin&#x27;?&quot;</span>&gt;&gt;),</span><br><span class="line">    &#123;[&#123;text, Msg&#125;], State&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">websocket_info</span><span class="params">(_Info, State)</span> -&gt;</span></span><br><span class="line">    &#123;[], State&#125;.</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="title">terminate</span><span class="params">(Reason, _PartialReq, _State)</span> -&gt;</span></span><br><span class="line">    io:format(<span class="string">&quot;Terminate reason: ~w ~w ~n&quot;</span>, [Reason, self()]),</span><br><span class="line">    conn_ets:remove_by_pid(self()),</span><br><span class="line">    <span class="comment">% case Reason of</span></span><br><span class="line">    <span class="comment">%     &#123;remote, 1001, _&#125; -&gt;    </span></span><br><span class="line">    <span class="comment">%         io:format(&quot;refresh.~n&quot;);</span></span><br><span class="line">    <span class="comment">%     &#123;timeout&#125; -&gt;</span></span><br><span class="line">    <span class="comment">%         io:format(&quot;timeout.~n&quot;);</span></span><br><span class="line">    <span class="comment">%     &#123;error, closed&#125; -&gt;</span></span><br><span class="line">    <span class="comment">%         io:format(&quot;closed page.~n&quot;)</span></span><br><span class="line">    <span class="comment">% end,</span></span><br><span class="line">    ok.</span><br></pre></td></tr></table></figure>

<h3 id="最后别忘了在启动时初始化"><a href="#最后别忘了在启动时初始化" class="headerlink" title="最后别忘了在启动时初始化:"></a>最后别忘了在启动时初始化:</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">-module</span><span class="params">(chess_app_app)</span>.</span><br><span class="line"><span class="keyword">-behaviour</span><span class="params">(application)</span>.</span><br><span class="line"></span><br><span class="line"><span class="keyword">-export</span><span class="params">([start/<span class="number">2</span>])</span>.</span><br><span class="line"><span class="keyword">-export</span><span class="params">([stop/<span class="number">1</span>])</span>.</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">start</span><span class="params">(_Type, _Args)</span> -&gt;</span></span><br><span class="line">    conn_ets:init(),</span><br><span class="line">    Dispatch = cowboy_router:compile([</span><br><span class="line">        &#123;&#x27;_&#x27;, [</span><br><span class="line">                &#123;<span class="string">&quot;/&quot;</span>, home_handler, []&#125;,</span><br><span class="line"><span class="comment">%%                 &#123;&quot;/[...]&quot;, cowboy_static, &#123;dir, &quot;priv/&quot;&#125;&#125;,</span></span><br><span class="line">                &#123;<span class="string">&quot;/index&quot;</span>, cowboy_static, &#123;file, <span class="string">&quot;priv/index.html&quot;</span>&#125;&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;/ws&quot;</span>, cowboy_static, &#123;file, <span class="string">&quot;priv/ws.html&quot;</span>&#125;&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;/websocket&quot;</span>, ws_h, []&#125;</span><br><span class="line">                ]&#125;</span><br><span class="line">    ]),</span><br><span class="line">    &#123;ok, _&#125; = cowboy:start_clear(my_http_listener,</span><br><span class="line">        [&#123;port, <span class="number">8080</span>&#125;],</span><br><span class="line">        #&#123;env =&gt; #&#123;dispatch =&gt; Dispatch&#125;&#125;</span><br><span class="line">    ),</span><br><span class="line">    chess_app_sup:start_link().</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stop</span><span class="params">(_State)</span> -&gt;</span></span><br><span class="line">    ok.</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/11/09/cowboy-websocket/" data-id="ckojh6voz0009twqrgu0h2j05" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Pkg-update-on-FreeBSD-11-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/10/19/Pkg-update-on-FreeBSD-11-1/" class="article-date">
  <time datetime="2020-10-19T06:29:28.000Z" itemprop="datePublished">2020-10-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/10/19/Pkg-update-on-FreeBSD-11-1/">Pkg update on FreeBSD 11.1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>解决办法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkg bootstrap -f</span><br><span class="line">pkg update -f</span><br></pre></td></tr></table></figure>

<p>系统更新：<br>*<a target="_blank" rel="noopener" href="https://www.freebsd.org/doc/zh_CN/books/handbook/updating-upgrading-freebsdupdate.html/">原文地址：help-the-world-by-healing-your-nginx-configuration</a>*<br>换国内源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/freebsd-update.conf <span class="comment"># change .org to .cn</span></span><br><span class="line">freebsd-update -r 12.1-RELEASE upgrade</span><br><span class="line">freebsd-update install</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/10/19/Pkg-update-on-FreeBSD-11-1/" data-id="ckojh6voy0007twqrdw5f2kbh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/OS/" rel="tag">OS</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-intro-postgres" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/09/22/intro-postgres/" class="article-date">
  <time datetime="2020-09-22T01:46:32.000Z" itemprop="datePublished">2020-09-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/SQL/">SQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/09/22/intro-postgres/">intro_postgres</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="创建数据库："><a href="#创建数据库：" class="headerlink" title="创建数据库："></a>创建数据库：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createdb -h localhost -U postgres -p 5432 mydb</span><br></pre></td></tr></table></figure>

<h4 id="用户登陆："><a href="#用户登陆：" class="headerlink" title="用户登陆："></a>用户登陆：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psql -h localhost -U postgres -p 5432 mydb</span><br></pre></td></tr></table></figure>

<h4 id="以超级用户登陆："><a href="#以超级用户登陆：" class="headerlink" title="以超级用户登陆："></a>以超级用户登陆：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su - postgres   1234567890</span><br></pre></td></tr></table></figure>

<h4 id="删除或者创建用户皆以数据库为依托："><a href="#删除或者创建用户皆以数据库为依托：" class="headerlink" title="删除或者创建用户皆以数据库为依托："></a>删除或者创建用户皆以数据库为依托：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">psql sqlname</span><br><span class="line">drop user role</span><br></pre></td></tr></table></figure>

<h4 id="创建角色和将数据库分配给角色："><a href="#创建角色和将数据库分配给角色：" class="headerlink" title="创建角色和将数据库分配给角色："></a>创建角色和将数据库分配给角色：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE name PASSWORD <span class="string">&#x27;string&#x27;</span></span><br><span class="line">CREATE DATABASE exampledb OWNER dbuser</span><br></pre></td></tr></table></figure>

<h4 id="删除表："><a href="#删除表：" class="headerlink" title="删除表："></a>删除表：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE tablename</span><br></pre></td></tr></table></figure>

<h4 id="删除表数据-但保留表结构："><a href="#删除表数据-但保留表结构：" class="headerlink" title="删除表数据,但保留表结构："></a>删除表数据,但保留表结构：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from users</span><br></pre></td></tr></table></figure>

<h4 id="超级管理员-postgres-登录，创建数据库并移交给某个用户："><a href="#超级管理员-postgres-登录，创建数据库并移交给某个用户：" class="headerlink" title="超级管理员 postgres 登录，创建数据库并移交给某个用户："></a>超级管理员 postgres 登录，创建数据库并移交给某个用户：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">psql -h localhost -U postgres</span><br><span class="line">CREATE DATABASE tempDB OWNER sunshuai</span><br></pre></td></tr></table></figure>

<h4 id="超级管理员直接创建数据库（所有者为超级管理员）："><a href="#超级管理员直接创建数据库（所有者为超级管理员）：" class="headerlink" title="超级管理员直接创建数据库（所有者为超级管理员）："></a>超级管理员直接创建数据库（所有者为超级管理员）：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createdb -h localhost -U postgres -p 5432 tempDB</span><br></pre></td></tr></table></figure>

<h4 id="备份和恢复："><a href="#备份和恢复：" class="headerlink" title="备份和恢复："></a>备份和恢复：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pg_dump -h localhost -U sunshuai tempdb &gt; dumpfile</span><br><span class="line">psql dbname &lt; dumpfile</span><br></pre></td></tr></table></figure>

<h4 id="赋予角色登陆权限"><a href="#赋予角色登陆权限" class="headerlink" title="赋予角色登陆权限"></a>赋予角色登陆权限</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">psql -h localhost -U postgres</span><br><span class="line">ALTER ROLE <span class="string">&quot;asunotest&quot;</span> WITH LOGIN</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/09/22/intro-postgres/" data-id="ckojh6vp0000atwqr1ml3haz4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Postgresql/" rel="tag">Postgresql</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-How_to_save_and_load_game_in_Godot_Engine" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/08/18/How_to_save_and_load_game_in_Godot_Engine/" class="article-date">
  <time datetime="2020-08-18T03:13:29.000Z" itemprop="datePublished">2020-08-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Game-Dev/">Game Dev</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/08/18/How_to_save_and_load_game_in_Godot_Engine/">How to save and load game in Godot Engine</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em><a target="_blank" rel="noopener" href="http://codetuto.com/2017/08/save-load-game-godot-engine/">原文地址：How to save and load game in Godot Engine</a></em></p>
<h3 id="创建两个-AutoLoad-gdscript-脚本文件"><a href="#创建两个-AutoLoad-gdscript-脚本文件" class="headerlink" title="创建两个 AutoLoad gdscript 脚本文件"></a>创建两个 AutoLoad gdscript 脚本文件</h3><p>Save the file into <strong>res://autoload/user_data_manager.gd</strong><br>Use the same process <strong>to create another script res://autoload/game_manager.gd</strong></p>
<p>Browse our two scripts and set their names as shown below.</p>
<p><strong>set scripts as autoload</strong><br><img src="/myblogs.github.io/assets/set-scripts-as-autoload.png"></p>
<p>To save and load game in Godot engine, we need to create some scripts. We will create this once and can be used in all of our game. So let us jump into scripting.</p>
<h3 id="User-Data-Manager-and-Game-Manager-scripting"><a href="#User-Data-Manager-and-Game-Manager-scripting" class="headerlink" title="User Data Manager and Game Manager scripting"></a>User Data Manager and Game Manager scripting</h3><p>The <strong>user_data_manager.gd</strong> script looks like:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">extends Node2D</span><br><span class="line">signal loaded</span><br><span class="line">signal version_mismatch</span><br><span class="line">const LOADED = <span class="string">&quot;loaded&quot;</span></span><br><span class="line">const VERSION_MISMATCH = <span class="string">&quot;version_mismatch&quot;</span></span><br><span class="line">var _path = <span class="string">&quot;path/to/save/data.dat&quot;</span> <span class="comment">#Change this to user://data.dat after testing</span></span><br><span class="line">var _user_data = &#123;&#125;</span><br><span class="line">func load_data(default_data, version):</span><br><span class="line">    _user_data[<span class="string">&quot;version&quot;</span>] = version</span><br><span class="line">    _user_data[<span class="string">&quot;data&quot;</span>] = default_data</span><br><span class="line">    var f = File.new()</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">not</span> f.file_exists(_path)):</span><br><span class="line">        save_data()</span><br><span class="line">    f.open(_path, File.READ)</span><br><span class="line">    var loaded_data = &#123;&#125;</span><br><span class="line">    loaded_data.parse_json(f.get_as_text())</span><br><span class="line">    _parse_loaded_data(loaded_data)</span><br><span class="line">    f.close()</span><br><span class="line">func _parse_loaded_data(loaded_data):</span><br><span class="line">    var loaded_version = loaded_data.version</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> loaded_data.data.keys():</span><br><span class="line">        _user_data[<span class="string">&quot;data&quot;</span>][key] = loaded_data[<span class="string">&quot;data&quot;</span>][key]</span><br><span class="line">    <span class="keyword">if</span>(loaded_version != _user_data.version):</span><br><span class="line">        emit_signal(VERSION_MISMATCH,loaded_version,loaded_data.data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        emit_signal(LOADED)</span><br><span class="line">func save_corrected_data(corrected_user_data):</span><br><span class="line">    _user_data[<span class="string">&quot;data&quot;</span>] = corrected_user_data</span><br><span class="line">    save_data()</span><br><span class="line">func update_version(version):</span><br><span class="line">    _user_data[<span class="string">&quot;version&quot;</span>] = version</span><br><span class="line">    save_data()</span><br><span class="line">func save_data():</span><br><span class="line">    var f = File.new()</span><br><span class="line">    f.open(_path,File.WRITE)</span><br><span class="line">    f.store_string(_user_data.to_json())</span><br><span class="line">    f.close()</span><br><span class="line">func set_data(key,value):</span><br><span class="line">    _user_data[<span class="string">&quot;data&quot;</span>][key] = value</span><br><span class="line">func get_data(key):</span><br><span class="line">    <span class="keyword">return</span> _user_data[<span class="string">&quot;data&quot;</span>][key]</span><br></pre></td></tr></table></figure>

<p>To understand the above script we have to look into the <strong>game_manager.gd</strong> script:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">extends Node2D</span><br><span class="line">var _default_user_data = &#123;</span><br><span class="line">    score = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">func _ready():</span><br><span class="line">    UserDataManager.connect(UserDataManager.LOADED,self,<span class="string">&quot;init&quot;</span>)</span><br><span class="line">    UserDataManager.connect(UserDataManager.VERSION_MISMATCH,self,<span class="string">&quot;_user_data_version_mismatch&quot;</span>)</span><br><span class="line">    UserDataManager.load_data(_default_user_data,<span class="string">&quot;0.0.1&quot;</span>);</span><br><span class="line">func _user_data_version_mismatch(loaded_version,loaded_data):</span><br><span class="line"><span class="comment">#    Check loaded_version, parse loaded_data and update the savedata</span></span><br><span class="line"><span class="comment">#    UserDataManager.save_corrected_data(corrected_data)</span></span><br><span class="line"><span class="comment">#    Then update the new version</span></span><br><span class="line"><span class="comment">#    UserDataManager.update_version(&quot;0.0.2&quot;)</span></span><br><span class="line">    init()</span><br><span class="line">func init():</span><br><span class="line">    print(<span class="string">&quot;INIT&quot;</span>)</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>Singleton in Godot is auto instantiated and available to every script by the name we set in the project settings. We have two Singleton objects now – UserDataManager and GameManager. Both can be accessed from any other script we are going to write for our game.</p>
<p>We have a default user data variable. This is a dictionary object. If there is no save data present when the game starts, this default data is used. In fact, it goes deeper, even if the loaded data has no records for a specified key then the value from this default data is used. This is possible when we update our game and has additional values to be saved.</p>
<p>When our game boots up, UserDataManager’s load_data method is called with the default data and a version string. This version string can be in any format but it should represent our game version somehow. The UserDataManager will load the save data from the disk. If there is no save data present, it creates a new one with the specified version. If our current game version is different than the one in the saved file, the version mismatch function is called. This is the place to write logic to convert the old user data format to the new one.</p>
<p>That’s it. We can initialize everything in the init() and UserDataManager will manage the saving and loading of our game.</p>
<p>This is how you save and load game in Godot Engine.</p>
<p>When we want to save any data we can call,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UserDataManager.set_data(<span class="string">&quot;health&quot;</span>,<span class="number">75</span>)</span><br><span class="line">UserDataManager.set_data(<span class="string">&quot;coins&quot;</span>,<span class="number">100</span>)</span><br><span class="line">UserDataManager.save_data()</span><br></pre></td></tr></table></figure>

<p>And to get something,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var player_health = UserDataManager.get_data(<span class="string">&quot;health&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Calling the above methods will work from any script and returns the value from our saved data. The above script will only work on 2.1.x versions of Godot engine. Godot 3.0 is just around the corner and scripting API is different for the Dictionary class. We will check it out when it is released.</p>
<p>If you really need an explanation for the user_data_manager.gd, let me know in the comments below. Thanks for reading.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/18/How_to_save_and_load_game_in_Godot_Engine/" data-id="ckojh6vor0001twqrgjmb3wn9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Godot/" rel="tag">Godot</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-通过修复NGINX配置帮助世界" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/08/17/%E9%80%9A%E8%BF%87%E4%BF%AE%E5%A4%8DNGINX%E9%85%8D%E7%BD%AE%E5%B8%AE%E5%8A%A9%E4%B8%96%E7%95%8C/" class="article-date">
  <time datetime="2020-08-17T08:29:17.000Z" itemprop="datePublished">2020-08-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/08/17/%E9%80%9A%E8%BF%87%E4%BF%AE%E5%A4%8DNGINX%E9%85%8D%E7%BD%AE%E5%B8%AE%E5%8A%A9%E4%B8%96%E7%95%8C/">通过修复NGINX配置帮助世界</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/help-the-world-by-healing-your-nginx-configuration/">原文地址：help-the-world-by-healing-your-nginx-configuration</a></em><br>海军上将威廉·麦克雷文2014年著名的演讲，在得克萨斯大学，他说，如果你想改变世界，通过使你的床开始。有时候，小事情可能会产生很大的影响-无论是早上铺床还是对网站的HTTP服务器配置进行少量更改。<br>这看起来像是夸大其词？2020年的头几个月，我们对世界上正常和合理事物的所有定义都花光了。由于COVID‑19大流行，地球上将近一半的人口被困在自己的家中，因此互联网已成为他们交流，娱乐，购买食物，工作和教育的唯一方式。互联网每周都比以往任何时候都拥有更高的网络流量和服务器负载。根据BroadbandNow在3月25日发布的报告，“在我们分析的200个城市中，有88个（44％）在过去一周内经历了一定程度的网络降级，而之前的10个星期是这样”。<br>诸如Netflix和YouTube之类的主要媒体平台都在限制其传输质量，以保护网络链接，使人们有更多带宽可用于工作，与家人交流或在学校上虚拟课。但这还不够，因为网络质量逐渐恶化，许多服务器变得超负荷。</p>
<h3 id="您可以通过优化网站来提供帮助"><a href="#您可以通过优化网站来提供帮助" class="headerlink" title="您可以通过优化网站来提供帮助"></a>您可以通过优化网站来提供帮助</h3><p>如果您拥有网站并可以管理其HTTP服务器配置，则可以提供帮助。进行一些小的更改可以减少用户生成的网络带宽以及服务器的负载。这是双赢的局面：如果您的站点当前负载沉重，则可以减少它，从而为更多的用户提供服务，并可能降低成本。如果负载不是很高，则更快的负载可以改善用户的体验（有时会积极影响您在Google搜索结果中的排名）。</p>
<p>如果您的应用程序每个月有数百万用户，或者是一个包含烘焙食谱的小博客，那都没有关系–您消除的每千字节网络流量都释放了容量，供那些迫切需要在线检查医学检查结果或创建包裹标签的人使用给亲戚寄一些重要的东西</p>
<p>在此博客中，我们介绍了您可以对NGINX配置进行的一些简单但功能强大的更改。举一个真实的例子，我们使用我的朋友Rogalove的电子商务网站，该公司是我居住的波兰一家生态化妆品制造商。该网站是运行NGINX 1.15.9作为其Web服务器的相当标准的WooCommerce安装。为了进行计算，我们假设该网站每天获得100个唯一身份用户，其中30％的用户为固定访问者，并且每个用户在会话期间平均访问4个页面。</p>
<p>这些技巧是您可以立即采取的简单步骤，以提高性能并减少网络带宽。如果您要处理大量流量，则可能需要实施更复杂的更改以产生重大影响，例如，调整操作系统和NGINX，提供正确的硬件容量，以及（最重要的是）启用和调整缓存。查看这些博客文章以获取详细信息：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/tuning-nginx/">调整NGINX的性能</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/performance-tuning-tips-tricks/">性能调优–技巧与窍门</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/10-tips-for-10x-application-performance/">10倍应用程序性能的10个技巧</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/resources/datasheets/nginx-plus-sizing-guide/">在裸机服务器上部署NGINX Plus的规模调整指南</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/nginx-caching-guide/">NGINX和NGINX Plus缓存指南</a></li>
<li><a target="_blank" rel="noopener" href="https://www.nginx.com/blog/benefits-of-microcaching-nginx/">使用NGINX进行微缓存的好处</a></li>
</ul>
<h3 id="为HTML，CSS和JavaScript文件启用Gzip压缩"><a href="#为HTML，CSS和JavaScript文件启用Gzip压缩" class="headerlink" title="为HTML，CSS和JavaScript文件启用Gzip压缩"></a>为HTML，CSS和JavaScript文件启用Gzip压缩</h3><p>如您所知，用于在现代网站上构建页面的HTML，CSS和JavaScript文件可能非常庞大。在大多数情况下，Web服务器可以即时压缩这些和其他文本文件，以节省网络带宽。</p>
<img src="/myblogs.github.io/assets/rogalove-devtools-no-gzip.png">

<p>如您在左下方所见，没有压缩：文本文件的大小为1.15 MB，并且传输了很多数据。</p>
<p>默认情况下，NGINX中禁用压缩，但是根据您的安装或Linux发行版，某些设置可能会在默认的nginx.conf文件中启用。在这里，我们在NGINX配置文件中启用gzip压缩：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gzip on;</span><br><span class="line">gzip_types application/xml application/json </span><br><span class="line">text/css text/javascript application/javascript;</span><br><span class="line">gzip_vary on;</span><br><span class="line">gzip_comp_level 6;</span><br><span class="line">gzip_min_length 500;</span><br></pre></td></tr></table></figure>

<p>如您在以下屏幕截图中所见，压缩后的数据传输量仅为260 KB ，减少了约80％！对于页面上的每个新用户，您可以节省大约917 KB的数据传输。对于我们的WooCommerce安装，每天62 MB，或每月1860 MB。</p>
<img src="/myblogs.github.io/assets/rogalove-devtools-gzip.png">

<h3 id="设置缓存头"><a href="#设置缓存头" class="headerlink" title="设置缓存头"></a>设置缓存头</h3><p>当浏览器检索网页的文件时，它会将副本保留在本地磁盘缓存中，这样，当您再次访问该页面时，它不必从服务器重新获取文件。每个浏览器都使用自己的逻辑来决定何时使用文件的本地副本以及何时在服务器上更改了文件时再次获取它。但是，作为网站所有者，您可以在发送的HTTP响应中设置缓存控制和过期标头，以提高浏览器的缓存行为的效率。从长远来看，您会收到很多不必要的HTTP请求。</p>
<p>首先，您可以为字体和图像设置较长的缓存过期时间，这些字体和图像可能不会经常更改（即使更改，它们通常也会获得新的文件名）。在以下示例中，我们指示客户端浏览器将字体和图像在本地缓存中保留一个月：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(?:jpg|jpeg|gif|png|ico|woff2)$ &#123;</span><br><span class="line">    expires 1M;</span><br><span class="line">    add_header Cache-Control <span class="string">&quot;public&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="启用HTTP-2协议支持"><a href="#启用HTTP-2协议支持" class="headerlink" title="启用HTTP / 2协议支持"></a>启用HTTP / 2协议支持</h3><p>HTTP / 2是用于服务网页的下一代协议，旨在更好地利用网络和主机服务器。根据Google文档，它可以更快地加载页面： 生成的协议对网络更友好，因为与HTTP / 1.x相比，使用的TCP连接更少。这意味着与其他流量的竞争减少，连接寿命更长，从而可以更好地利用可用网络容量。 NGINX 1.9.5和更高版本（以及NGINX Plus R7和更高版本）支持HTTP / 2协议，您所需要做的就是启用它。为此，请在您的NGINX配置文件中http2的listen指令中包含参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">listen 443 ssl http2;</span><br></pre></td></tr></table></figure>
<p>请注意，在大多数情况下，您还需要启用TLS才能使用HTTP / 2。 您可以通过HTTP2.Pro服务验证您（或任何站点）是否支持HTTP/2:<br><img src="/myblogs.github.io/assets/rogalove-http2-pro.png"></p>
<h3 id="优化记录"><a href="#优化记录" class="headerlink" title="优化记录"></a>优化记录</h3><p>让自己喝一杯自己喜欢的饮料，舒适地坐着，然后思考：您上次查看访问日志文件是什么时候？上周，上个月，从来没有？即使将其用于站点的日常监视，您也可能只关注错误（400和500状态代码等），而不关注成功的请求。</p>
<p>通过减少或消除不必要的日志记录，可以节省服务器上的磁盘存储，CPU和I / O操作。这不仅使您的服务器更快一点-如果将您部署在云环境中，则释放的I / O吞吐量和CPU周期可能为同一虚拟机上的其他虚拟机或应用程序节省生命。</p>
<p>有几种不同的方法可以减少和优化日志记录。在这里，我们重点介绍三个。</p>
<h4 id="方法1：禁用页面资源请求的记录"><a href="#方法1：禁用页面资源请求的记录" class="headerlink" title="方法1：禁用页面资源请求的记录"></a>方法1：禁用页面资源请求的记录</h4><p>如果您不需要记录检索普通页面资源（例如图像，JavaScript文件和CSS文件）的请求，则这是一种快速简便的解决方案。您需要做的就是创建一个location与这些文件类型匹配的新块，并禁用其中的日志记录。（您也可以将此access_log指令添加到我们设置标头的上方的location块中。）Cache-Control</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(?:jpg|jpeg|gif|png|ico|woff2|js|css)$ &#123;</span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="方法2：禁用成功请求的日志记录"><a href="#方法2：禁用成功请求的日志记录" class="headerlink" title="方法2：禁用成功请求的日志记录"></a>方法2：禁用成功请求的日志记录</h4><p>这是一种更强大的方法，因为它会丢弃带有或响应代码的查询，仅记录错误。它比方法1稍微复杂一点，因为它取决于如何配置NGINX日志记录。在我们的示例中，我们使用Ubuntu Server发行版中包含的标准nginx.conf，因此，无论虚拟主机如何，所有请求都记录到/var/log/nginx/access.log中。2xx3xx</p>
<p>使用官方NGINX文档中的示例，让我们打开条件日志记录。创建一个变量$loggable，并将其设置为，0以使用和代码进行请求，否则设置为 。然后在指令中将此变量作为条件引用。2xx3xx1access_log</p>
<p>这是/etc/nginx/nginx.conf中http上下文中的原始指令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log /var/<span class="built_in">log</span>/nginx/access.log;</span><br></pre></td></tr></table></figure>

<p>添加一个map块并从access_log指令中引用它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map <span class="variable">$status</span> <span class="variable">$loggable</span> &#123;</span><br><span class="line">    ~^[23] 0;</span><br><span class="line">    default 1;</span><br><span class="line">&#125;</span><br><span class="line">access_log /var/<span class="built_in">log</span>/nginx/access.log combined <span class="keyword">if</span>=<span class="variable">$loggable</span>;</span><br></pre></td></tr></table></figure>
<p>请注意，尽管这combined是默认的日志格式，但是在包含if参数时，您需要明确指定它。</p>
<h4 id="方法3：使用缓冲最小化I-O操作"><a href="#方法3：使用缓冲最小化I-O操作" class="headerlink" title="方法3：使用缓冲最小化I / O操作"></a>方法3：使用缓冲最小化I / O操作</h4><p>即使您要记录所有请求，也可以通过打开访问日志缓冲来最大程度地减少I / O操作。使用此指令，NGINX会等待将日志数据写入磁盘，直到填满512 KB缓冲区或自上次刷新以来经过1分钟（以先发生者为准）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log /var/<span class="built_in">log</span>/nginx/access.log combined buffer=512k flush=1m;</span><br></pre></td></tr></table></figure>

<h3 id="限制特定URL的带宽"><a href="#限制特定URL的带宽" class="headerlink" title="限制特定URL的带宽"></a>限制特定URL的带宽</h3><p>如果服务器提供较大的文件（或较小但非常受欢迎的文件，例如表单或报表），则设置客户端下载文件的最大速度可能很有用。如果您的站点已经承受了很高的网络负载，则限制下载速度会留下更多带宽，以使应用程序的关键部分保持响应速度。这是硬件制造商使用的非常流行的解决方案–您可能需要等待更长的时间才能为打印机下载3 GB的驱动程序，但是同时有成千上万的其他人下载您仍然可以下载。😉</p>
<p>使用limit_rate指令限制特定URL的带宽。在这里，我们将/ download 下每个文件的传输速率限制为每秒50 KB。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location /download/ &#123;</span><br><span class="line">    limit_rate 50k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>您可能还希望仅对较大的文件进行速率限制，这可以使用limit_rate_after指令进行。在此示例中，每个文件（来自任何目录）的前500 KB都不受速度限制地进行传输，之后的所有内容均以50 KB / s为上限。这样可以加快网站关键部分的交付速度，同时降低其他部分的速度。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    limit_rate_after 500k;</span><br><span class="line">    limit_rate 50k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>请注意，速率限制适用于浏览器和NGINX之间的单个HTTP连接，因此请不要阻止用户使用下载管理器来解决速率限制。 最后，您还可以限制到服务器的并发连接数或请求速率。有关详细信息，请参见我们的文档。</p>
<h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>我们希望这五个技巧能帮助您优化网站的性能。速度和带宽增益因网站而异。即使调整您的NGINX配置似乎并没有显着释放带宽或提高速度，成千上万的网站单独调整其NGINX配置的整体影响还是会加在一起。我们的全球网络得到更有效的利用，这意味着最关键的服务将在需要时提供。 如果您在站点上遇到有关NGINX的任何问题，我们将为您提供帮助！在COVID‑19大流行期间，NGINX员工和社区正在监视Stack Overflow 1上的NGINX通道，并尽快答复问题和要求。 如果您在流行病最前沿的组织工作并有高级需求，则您可能有资格获得最多五个免费的NGINX Plus许可证以及更高级别的F5 DNS负载平衡器云服务。有关详细信息，请参见受COVID‑19影响的网站的免费资源。 还可以查看该博客，了解使用NGINX和F5的免费资源来提高网站性能的其他简便方法的摘要。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/17/%E9%80%9A%E8%BF%87%E4%BF%AE%E5%A4%8DNGINX%E9%85%8D%E7%BD%AE%E5%B8%AE%E5%8A%A9%E4%B8%96%E7%95%8C/" data-id="ckojh6vp6000jtwqr2ib63tf8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Nginx/" rel="tag">Nginx</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-用threejs开发3D微信小游戏贪食蛇" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/08/14/%E7%94%A8threejs%E5%BC%80%E5%8F%913D%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F%E8%B4%AA%E9%A3%9F%E8%9B%87/" class="article-date">
  <time datetime="2020-08-14T08:08:35.000Z" itemprop="datePublished">2020-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/08/14/%E7%94%A8threejs%E5%BC%80%E5%8F%913D%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F%E8%B4%AA%E9%A3%9F%E8%9B%87/">用threejs开发3D微信小游戏贪食蛇</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>现在在github已经有现成的threejs的weapp-ddapter.js了。但我早前做得时候没有找到，只找到修改weapp-ddapter的方式。</p>
<h3 id="修改-1：在变量document对象里增加以下函数："><a href="#修改-1：在变量document对象里增加以下函数：" class="headerlink" title="修改 1：在变量document对象里增加以下函数："></a>修改 1：在变量document对象里增加以下函数：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">createElementNS: <span class="function"><span class="keyword">function</span> <span class="title">createElementNS</span>(<span class="params">nameSpace, tagName</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.createElement(tagName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="修改-2：在函数-createClass-XMLHTTPRequest-key-’abort’…-…-参数中增加addEventListener函数："><a href="#修改-2：在函数-createClass-XMLHTTPRequest-key-’abort’…-…-参数中增加addEventListener函数：" class="headerlink" title="修改 2：在函数_createClass(XMLHTTPRequest, [{key:’abort’…}, …])()参数中增加addEventListener函数："></a>修改 2：在函数_createClass(XMLHTTPRequest, [{key:’abort’…}, …])()参数中增加addEventListener函数：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  key: <span class="string">&#x27;addEventListener&#x27;</span>,</span><br><span class="line">  value: <span class="function"><span class="keyword">function</span> <span class="title">addEventListener</span>(<span class="params">type, listener</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> listener === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> event = &#123; <span class="attr">target</span>: <span class="built_in">this</span> &#125;</span><br><span class="line">      <span class="keyword">let</span> that = <span class="built_in">this</span></span><br><span class="line">      <span class="built_in">this</span>[<span class="string">&#x27;on&#x27;</span> + type] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        listener.call(that, event)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自此微信小游戏就可以支持threejs了，下面开始做个简单的小游戏。<br>这个游戏需要用到两个js库，用以辅助Threejs。<br><strong>1: Detector.js</strong><br>Detector用来检测threejs的兼容性。<br><strong>2: OrbitControls.js</strong><br>OrbitControls用来作为threejs的轨道控制器。<br>额外的，如果想监测threejs的性能帧数，可以用stats.js。这里的Demo比较简单，就不用它了。<br>初始化先检测webgl的兼容性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (g.Detector.webgl) &#123;</span><br><span class="line">    <span class="built_in">this</span>.scene = <span class="keyword">new</span> THREE.Scene();</span><br><span class="line">    <span class="built_in">this</span>.camera = <span class="keyword">new</span> THREE.PerspectiveCamera( <span class="number">75</span>, g.innerWidth/g.innerHeight, <span class="number">0.1</span>, <span class="number">1000</span> );</span><br><span class="line">    <span class="built_in">this</span>.renderer = <span class="keyword">new</span> THREE.WebGLRenderer();</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//如果不兼容，需要显示出warning提示</span></span><br><span class="line">    <span class="keyword">var</span> warning = Detector.getWebGLErrorMessage();</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的小游戏场景，按钮，为了省事都以立方体cube代替。食物cube在场景随机产生，同时设置随机颜色。 在操作上，设定为在场景cube的6个面各有一个按钮cube，通过点击这6个按钮控制小蛇在空间的移动方向。为了方便观察，我们 设置食物cube，小蛇cube均有alpha = 0.4的透明度。<br>效果图如下：<br><img src="/myblogs.github.io/assets/threejs1.jpg"><br><img src="/myblogs.github.io/assets/threejs2.jpg"><br>需要改进：这里玩了几把，操作上需要不断的调整场景角度才能很好的操作小蛇，操作比较僵硬。暂时没有好的操作优化思路，暂时就到这吧，有空闲时间再研究。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/14/%E7%94%A8threejs%E5%BC%80%E5%8F%913D%E5%BE%AE%E4%BF%A1%E5%B0%8F%E6%B8%B8%E6%88%8F%E8%B4%AA%E9%A3%9F%E8%9B%87/" data-id="ckojh6vp4000ftwqrebal4ngw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Wexin/" rel="tag">Wexin</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Install_Nodejs_On_FreeBSD11" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/myblogs.github.io/2020/08/14/Install_Nodejs_On_FreeBSD11/" class="article-date">
  <time datetime="2020-08-14T07:10:21.000Z" itemprop="datePublished">2020-08-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/myblogs.github.io/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/myblogs.github.io/2020/08/14/Install_Nodejs_On_FreeBSD11/">Install Nodejs On FreeBSD 11.1</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="安装-NodeJS"><a href="#安装-NodeJS" class="headerlink" title="安装  NodeJS:"></a>安装  NodeJS:</h3><p>这里用懒惰的办法，直接安装二进制包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg install node</span><br></pre></td></tr></table></figure>
<p>（PS:网络好的话还是ports源码安装比较好）<br>安装过程是没有任何问题的，但是我想 node -v看下版本测试是否真的安装成功的时候。<br>然后就出事了：<br><font color=#dd0000>Undefined symbol “nghttp2_submit_origin” nodejs FreeBSD</font><br>好在FreeBSD的优势就是文档详细，在官方文档找到如下：<br><img src="/myblogs.github.io/assets/freebsd_node.jpg"><br>其实真正导致这个问题的是缺少 libnghttp2但是我看到我的系统自带python 版本是python27-2.7.13，为了不出其他的幺蛾子，索性把依赖的库都升级到requires的版本了。<br>把依赖的包依次安装或更新，问题瞬间解决。完美</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/14/Install_Nodejs_On_FreeBSD11/" data-id="ckojh6vou0003twqr1lh98q36" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/myblogs.github.io/tags/Nodejs/" rel="tag">Nodejs</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/myblogs.github.io/categories/Erlang/">Erlang</a></li><li class="category-list-item"><a class="category-list-link" href="/myblogs.github.io/categories/Game-Dev/">Game Dev</a></li><li class="category-list-item"><a class="category-list-link" href="/myblogs.github.io/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/myblogs.github.io/categories/Web/">Web</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Godot/" rel="tag">Godot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Nginx/" rel="tag">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/OS/" rel="tag">OS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Postgresql/" rel="tag">Postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/myblogs.github.io/tags/Wexin/" rel="tag">Wexin</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/myblogs.github.io/tags/Godot/" style="font-size: 10px;">Godot</a> <a href="/myblogs.github.io/tags/Nginx/" style="font-size: 10px;">Nginx</a> <a href="/myblogs.github.io/tags/Nodejs/" style="font-size: 10px;">Nodejs</a> <a href="/myblogs.github.io/tags/OS/" style="font-size: 10px;">OS</a> <a href="/myblogs.github.io/tags/Postgresql/" style="font-size: 10px;">Postgresql</a> <a href="/myblogs.github.io/tags/Web/" style="font-size: 10px;">Web</a> <a href="/myblogs.github.io/tags/Wexin/" style="font-size: 10px;">Wexin</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/myblogs.github.io/archives/2021/05/">五月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/myblogs.github.io/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/myblogs.github.io/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/myblogs.github.io/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/myblogs.github.io/archives/2020/08/">八月 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/myblogs.github.io/2021/05/11/Auto%20render%20and%20output%20in%20Blender%20with%20Python/">Blender Python API Render And Output</a>
          </li>
        
          <li>
            <a href="/myblogs.github.io/2020/11/09/cowboy-websocket/">cowboy websocket (boardcast)</a>
          </li>
        
          <li>
            <a href="/myblogs.github.io/2020/10/19/Pkg-update-on-FreeBSD-11-1/">Pkg update on FreeBSD 11.1</a>
          </li>
        
          <li>
            <a href="/myblogs.github.io/2020/09/22/intro-postgres/">intro_postgres</a>
          </li>
        
          <li>
            <a href="/myblogs.github.io/2020/08/18/How_to_save_and_load_game_in_Godot_Engine/">How to save and load game in Godot Engine</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 svensma<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/myblogs.github.io/" class="mobile-nav-link">Home</a>
  
    <a href="/myblogs.github.io/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/myblogs.github.io/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>


  
<link rel="stylesheet" href="/myblogs.github.io/fancybox/jquery.fancybox.css">

  
<script src="/myblogs.github.io/fancybox/jquery.fancybox.pack.js"></script>




<script src="/myblogs.github.io/js/script.js"></script>




  </div>
</body>
</html>